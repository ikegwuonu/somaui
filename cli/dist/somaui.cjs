#!/usr/bin/env node
"use strict";var J=Object.create;var I=Object.defineProperty;var L=Object.getOwnPropertyDescriptor;var M=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,G=Object.prototype.hasOwnProperty;var H=(e,o,r,t)=>{if(o&&typeof o=="object"||typeof o=="function")for(let l of M(o))!G.call(e,l)&&l!==r&&I(e,l,{get:()=>o[l],enumerable:!(t=L(o,l))||t.enumerable});return e};var j=(e,o,r)=>(r=e!=null?J(N(e)):{},H(o||!e||!e.__esModule?I(r,"default",{value:e,enumerable:!0}):r,e));var B=require("commander");var p=j(require("fs"),1),u=j(require("path"),1);var f=j(require("fs"),1),g=j(require("path"),1);function D(){return f.default.existsSync("pnpm-lock.yaml")?"pnpm":f.default.existsSync("yarn.lock")?"yarn":f.default.existsSync("package-lock.json")?"npm":"unknown"}function P(e=process.cwd()){let o=e;for(;o!==g.default.parse(o).root;){if(f.default.existsSync(g.default.join(o,"package.json")))return o;o=g.default.dirname(o)}return null}function F(e){return JSON.parse(f.default.readFileSync(g.default.join(e,"package.json"),"utf8"))}function U(e){let o={...e.dependencies,...e.devDependencies};return o.next?"next":o.vite?"vite":o["react-scripts"]?"cra":"unknown"}function R(e,o){let t=!!{...o.dependencies,...o.devDependencies}.tailwindcss;return(f.default.existsSync(g.default.join(e,"tailwind.config.js"))||f.default.existsSync(g.default.join(e,"tailwind.config.ts"))||f.default.existsSync(g.default.join(e,"tailwind.config.cjs")))&&console.log("Tailwind config file is deprecated in v4"),t}function A(e){return f.default.existsSync(g.default.join(e,"tsconfig.json"))}function T(){let e=P();if(!e)throw new Error("Could not find project root (package.json not found)");let o=F(e);return{root:e,framework:U(o),tailwind:R(e,o),typescript:A(e),packageManager:D()}}var y=j(require("fs"),1),b=j(require("path"),1);function S(e,o,r=!1){if(!y.default.existsSync(e))throw new Error(`Source not found: ${e}`);if(y.default.statSync(e).isDirectory()){y.default.existsSync(o)||y.default.mkdirSync(o,{recursive:!0});let l=y.default.readdirSync(e);for(let i of l){let s=b.default.join(e,i),c=b.default.join(o,i);S(s,c,r)}}else(!y.default.existsSync(o)||r)&&(y.default.mkdirSync(b.default.dirname(o),{recursive:!0}),y.default.copyFileSync(e,o))}function W(){let e=T();console.log("\u{1F50D} Detected project setup:"),console.log(e),e.tailwind||(console.log(`
\u26A0\uFE0F  Install Tailwind v4+ and @tailwindcss/forms plugin to use SomaUI components.`),console.log("   Learn more: https://tailwindcss.com/docs/installation"));let o=process.cwd(),r=u.default.resolve(__dirname,"../../packages/ui"),t=u.default.join(o,"src/styles/global.css"),l=u.default.join(r,"global.css");if(p.default.existsSync(t))console.log("\u26A0\uFE0F src/styles/global.css already exists");else if(p.default.mkdirSync(u.default.dirname(t),{recursive:!0}),p.default.existsSync(l))p.default.copyFileSync(l,t),console.log("\u2705 Copied src/styles/global.css from SomaUI");else{let m='@import "tailwindcss";';p.default.copyFileSync(l,t),console.log("\u2705 Created src/styles/global.css"),console.log("\u26A0\uFE0F Iniialize SomaUI with npx somaui init to get lib, icons and components folders.")}let i=u.default.join(o,"src/icons"),s=u.default.join(r,"src/icons");p.default.existsSync(i)?console.log("\u26A0\uFE0F src/icons/ already exists"):p.default.existsSync(s)?(S(s,i),console.log("\u2705 Copied src/icons/ folder from SomaUI")):(p.default.mkdirSync(i,{recursive:!0}),console.log("\u2705 Created src/icons/ folder"));let c=u.default.join(o,"src/lib"),n=u.default.join(r,"src/lib");p.default.existsSync(c)?console.log("\u26A0\uFE0F src/lib/ already exists"):p.default.existsSync(n)?(S(n,c),console.log("\u2705 Copied src/lib/ folder from SomaUI")):(p.default.mkdirSync(c,{recursive:!0}),console.log("\u2705 Created src/lib/ folder"));let x=u.default.join(o,"src/components");p.default.existsSync(x)?console.log("\u26A0\uFE0F src/components/ already exists"):(p.default.mkdirSync(x,{recursive:!0}),console.log("\u2705 Created src/components/ folder")),console.log(`
\u{1F389} SomaUI initialized!

Next steps:
1. Configure path aliases in your project:
   // tsconfig.json or vite.config.ts
   {
     "@/*": ["./src/*"],
     "@/lib/*": ["./src/lib/*"]
   }

2. Add components:
   npx somaui add button
   npx somaui add button input card
   npx somaui add --all
   npx somaui add button --overwrite
`)}var d=j(require("fs"),1),a=j(require("path"),1);var _=a.default.resolve(__dirname,"../../packages/ui/src/components"),O=a.default.resolve(__dirname,"../../packages/ui/meta.json");function z(e,o){let r=o.cwd||process.cwd(),t=a.default.join(r,"src/components"),l=!!o.overwrite,i=!!o.all;d.default.existsSync(t)||(console.error("\u274C Project not initialized. Run `npx somaui init` first."),process.exit(1)),d.default.existsSync(O)||(console.error("\u274C meta.json not found in SomaUI package"),process.exit(1));let s=JSON.parse(d.default.readFileSync(O,"utf8")),c=i?Object.keys(s):e;c.length===0&&(console.error("\u274C No components specified. Use `somaui add <component>` or `--all`."),process.exit(1));for(let m of c)s[m]||(console.error(`\u274C Component "${m}" not found in SomaUI`),process.exit(1));let n=new Set,x=[];for(let m of c){console.log(`\u{1F4E6} Adding ${m}...`);let C=`components/${m}`;n.has(C)?console.log(`  \u23ED\uFE0F ${m} already installed`):q(m,t,l)&&(n.add(C),x.push(m),console.log(`  \u2705 ${m}`));let E=s[m];for(let w of E)if(!n.has(w)&&Q(w,r,l)){n.add(w);let $=K(w);x.push($),console.log(`  \u{1F4CD} ${$} (dependency)`)}console.log()}console.log("\u{1F389} Installation Complete!"),console.log(`\u2705 Added ${x.length} item(s) to your project:`),x.forEach(m=>console.log(`  \u2022 ${m}`)),x.length>0&&(console.log(`
\u2728 Components available at: src/components/`),console.log("\u{1F4DD} Remember: @/lib imports use path aliases (configure in your build tool)"))}function K(e){return e.replace(/^components\//,"").replace(/\.tsx$/,"")}function q(e,o,r){let t=a.default.join(_,`${e}.tsx`),l=a.default.join(_,e),i="",s=!1;if(d.default.existsSync(l)&&d.default.statSync(l).isDirectory())i=l,s=!0;else if(d.default.existsSync(t))i=t,s=!1;else return console.warn(`  \u26A0\uFE0F Component not found: ${e}`),!1;let c=s?a.default.join(o,e):a.default.join(o,`${e}.tsx`);return d.default.existsSync(c)&&!r?(console.log(`  \u23ED\uFE0F ${e} already exists`),!1):(d.default.mkdirSync(a.default.dirname(c),{recursive:!0}),s?(S(i,c,r),v(c)):(d.default.copyFileSync(i,c),k(c)),!0)}function Q(e,o,r){let t=a.default.resolve(__dirname,"../../packages/ui/src"),l=a.default.join(o,"src"),i=a.default.join(t,e);if(!d.default.existsSync(i))return console.warn(`  \u26A0\uFE0F Dependency not found: ${e}`),!1;let s=a.default.join(l,e);return d.default.existsSync(s)&&!r?!1:(d.default.mkdirSync(a.default.dirname(s),{recursive:!0}),d.default.statSync(i).isDirectory()?(S(i,s,r),v(s)):(d.default.copyFileSync(i,s),k(s)),!0)}function v(e){if(!d.default.existsSync(e))return;let o=d.default.readdirSync(e,{withFileTypes:!0});for(let r of o){let t=a.default.join(e,r.name);r.isDirectory()?v(t):(t.endsWith(".tsx")||t.endsWith(".ts")||t.endsWith(".js")||t.endsWith(".jsx"))&&k(t)}}function k(e){try{let o=d.default.readFileSync(e,"utf-8"),r=o,t=a.default.dirname(e),l=process.cwd();o=o.replace(/from\s+['"]@\/components\/([^'"]+)['"]/g,(i,s)=>{try{let c=a.default.join(l,"src/components",s),n=a.default.relative(t,c);return n.startsWith(".")||(n="./"+n),n=n.replace(/\.(tsx|ts|js|jsx)$/,""),`from "${n}"`}catch{return i}}),o=o.replace(/from\s+['"]@\/icons\/([^'"]+)['"]/g,(i,s)=>{try{let c=a.default.join(l,"src/icons",s),n=a.default.relative(t,c);return n.startsWith(".")||(n="./"+n),n=n.replace(/\.(tsx|ts|js|jsx)$/,""),`from "${n}"`}catch{return i}}),o=o.replace(/from\s+['"]\.\/([^'"]+)['"]/g,(i,s)=>{try{let c=a.default.join(t,s),n=a.default.relative(t,c);return n.startsWith(".")||(n="./"+n),n=n.replace(/\.(tsx|ts|js|jsx)$/,""),`from "${n}"`}catch{return i}}),o=o.replace(/from\s+['"]\.\.\/([^'"]+)['"]/g,(i,s)=>{try{let c=a.default.join(t,"..",s),n=a.default.relative(t,c);return n.startsWith(".")||(n="./"+n),n=n.replace(/\.(tsx|ts|js|jsx)$/,""),`from "${n}"`}catch{return i}}),o!==r&&d.default.writeFileSync(e,o,"utf-8")}catch{console.warn(`  \u26A0\uFE0F Could not update imports in ${a.default.relative(process.cwd(),e)}`)}}var h=new B.Command;h.name("somaui").description("SomaUI CLI - Add beautiful UI components to your project").version("1.0.0");h.command("init").description("Initialize SomaUI in your project (copies global.css, lib, icons)").action(()=>{W()});h.command("add").description("Add components to your project with dependencies").argument("[components...]","Component names to add").option("-a, --all","Add all components").option("-o, --overwrite","Overwrite existing files").option("-c, --cwd <path>","Working directory").action((e,o)=>{z(e,o)});h.addHelpText("after",`
Examples:
  $ npx somaui init
  $ npx somaui add button
  $ npx somaui add button input checkbox
  $ npx somaui add --all
  $ npx somaui add button --overwrite

Important:
  \u2022 Run 'init' first to set up project structure
  \u2022 Configure path aliases (@/lib/*) in your build tool
  \u2022 Use --overwrite to update existing components
`);h.parse();
