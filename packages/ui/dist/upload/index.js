import {b,a as a$1}from'../chunk-W5GEZT5G.js';import {b as b$1,a as a$2}from'../chunk-45KJTAK6.js';import'../chunk-VA57PCYD.js';import {a}from'../chunk-BVZYQBQW.js';import {useCallback,useRef,useState,useImperativeHandle,useEffect,useMemo}from'react';import {tv}from'tailwind-variants';import {jsxs,jsx}from'react/jsx-runtime';var ve=tv({slots:{container:"flex items-center peer w-full transition duration-200 rounded-[var(--border-radius)] border-[length:var(--border-width)]",input:"w-full border-0 bg-transparent p-0 focus:outline-none focus:ring-0",button:"[&::file-selector-button]:inline-flex [&::file-selector-button]:font-medium [&::file-selector-button]:leading-none [&::file-selector-button]:items-center [&::file-selector-button]:justify-center [&::file-selector-button]:border-0 [&::file-selector-button]:focus-visible:ring-2 [&::file-selector-button]:focus-visible:ring-opacity-50 [&::file-selector-button]:bg-primary [&::file-selector-button]:hover:enabled:bg-primary-dark [&::file-selector-button]:focus-visible:ring-primary/30 [&::file-selector-button]:text-primary-foreground [&::file-selector-button]:rounded-[calc(var(--border-radius)-2px)]"},variants:{variant:{outline:{container:"bg-transparent focus-within::ring-[0.8px] ring-border border-border [&_input::placeholder]:text-gray-500 hover:border-primary focus-within::border-primary focus-within::ring-primary"},text:{container:"border-0 focus-within::ring-2 bg-transparent [&_input::placeholder]:opacity-70 hover:text-primary-dark focus-within::ring-primary/30 text-primary"}},size:{sm:{container:"pr-2 py-1 text-xs h-8 pl-[1px]",button:"[&::file-selector-button]:h-7 [&::file-selector-button]:px-2.5"},md:{container:"pr-3.5 py-2 text-sm h-10 pl-[1px]",button:"[&::file-selector-button]:h-9 [&::file-selector-button]:px-3.5"},lg:{container:"pr-4 py-2 text-base h-12 pl-[1px]",button:"[&::file-selector-button]:h-11 [&::file-selector-button]:px-4"}},disabled:{true:{container:"!bg-muted/70 backdrop-blur cursor-not-allowed !border-muted !text-muted-foreground",input:"cursor-not-allowed placeholder:text-muted-foreground",button:"[&::file-selector-button]:bg-muted-foreground [&::file-selector-button]:text-foreground [&::file-selector-button]:dark:text-muted"}},error:{true:{container:"!border-red hover:!border-red focus:!border-red !ring-red"}},clearable:{true:{input:"[&:placeholder-shown~.input-clear-btn]:opacity-0 [&:placeholder-shown~.input-clear-btn]:invisible [&:not(:placeholder-shown)~.input-clear-btn]:opacity-100 [&:not(:placeholder-shown)~.input-clear-btn]:visible"}}},defaultVariants:{variant:"outline",size:"md"}});function he({className:i,variant:N="outline",size:l="md",disabled:r,placeholder:v,label:E,labelWeight:b$2="medium",error:c,clearable:C,onClear:w,readOnly:Z,helperText:I,labelClassName:P,inputClassName:U,errorClassName:k,helperClassName:h,ref:j,...L}){let u=useCallback(F=>{F.preventDefault(),w&&w(F);},[w]),{container:p,input:g,button:O}=ve({variant:N,size:l,disabled:r,error:!!c,clearable:C});return jsxs("div",{className:a("somaui-file-input-root","flex flex-col",i),children:[jsxs("label",{className:"block",children:[E?jsx("span",{className:a("somaui-file-input-label","block",b.size[l],b.weight[b$2],r&&"text-muted-foreground",P),children:E}):null,jsxs("span",{className:p({className:U}),children:[jsx("input",{ref:j,type:"file",disabled:r,readOnly:Z,spellCheck:"false","aria-invalid":c?"true":void 0,"aria-required":L.required,className:a(g(),O()),style:{fontSize:"inherit"},...L}),C&&jsx(a$1,{size:l,onClick:u})]})]}),!c&&I?jsx(b$1,{size:l,className:a("somaui-file-input-helper-text",r&&"text-muted-foreground",h),children:I}):null,c?jsx(a$2,{size:l,error:c,className:a("somaui-file-input-error-text",k)}):null]})}var ke="Drag & drop files here or click to browse",Le=({className:i})=>jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),Re=({className:i})=>jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),De=({className:i})=>jsx("svg",{className:i,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});function Te({file:i,className:N}){let[l,r]=useState("");return useEffect(()=>{let v=URL.createObjectURL(i);return r(v),()=>{URL.revokeObjectURL(v);}},[i]),l?jsx("img",{src:l,alt:i.name,className:N}):null}var Ee=tv({slots:{root:"flex flex-col",uploadZoneArea:"relative flex flex-col items-center justify-center border-2 border-dashed rounded-[var(--border-radius)] transition-all duration-200 cursor-pointer",input:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",content:"flex flex-col items-center justify-center text-center pointer-events-none relative z-0",icon:"mb-2",text:"text-sm",previewContainer:"mt-4 space-y-2",previewGrid:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",previewItem:"relative group rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-700",previewImage:"w-full h-full object-cover",previewRemoveButton:"absolute top-2 right-2 bg-red text-white rounded-full p-1.5 opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-dark cursor-pointer"},variants:{variant:{outline:{uploadZoneArea:"bg-transparent border-border hover:border-primary hover:bg-muted/30 focus-visible:border-primary focus-visible:bg-muted/30 focus-visible:outline-none"},flat:{uploadZoneArea:"bg-muted/30 backdrop-blur border-border hover:border-primary hover:bg-muted/50 focus-visible:border-primary focus-visible:bg-muted/50 focus-visible:outline-none"}},size:{sm:{uploadZoneArea:"p-6 min-h-[120px]",text:"text-xs",icon:"mb-1.5"},md:{uploadZoneArea:"p-8 min-h-[160px]",text:"text-sm",icon:"mb-2"},lg:{uploadZoneArea:"p-12 min-h-[200px]",text:"text-base",icon:"mb-3"}},isDragging:{true:{uploadZoneArea:"border-primary bg-primary/5 dark:bg-primary/10 scale-[1.02]"}},disabled:{true:{uploadZoneArea:"!bg-muted/70 backdrop-blur cursor-not-allowed !border-muted opacity-60",input:"cursor-not-allowed"}},error:{true:{uploadZoneArea:"!border-red hover:!border-red focus-visible:!border-red focus-visible:outline-none"}}},defaultVariants:{variant:"outline",size:"md"}});function Ce({className:i,variant:N="outline",size:l="md",disabled:r,label:v,labelWeight:E="medium",error:b$2,helperText:c,labelClassName:C,uploadZoneClassName:w,contentClassName:Z,helperClassName:I,errorClassName:P,previewClassName:U,multiple:k,accept:h,placeholder:j,icon:L,value:u,onChange:p,onDrop:g,name:O,ref:F,...$}){let V=useRef(null),[_,B]=useState(false),[Ie,S]=useState(0),[K,x]=useState([]);useImperativeHandle(F,()=>V.current,[]),useEffect(()=>{u!==void 0&&(u===null?x([]):u instanceof FileList?x(Array.from(u)):Array.isArray(u)&&x(u));},[u]);let G=useCallback(e=>{let o=e instanceof FileList?Array.from(e):e;if(k)x(a=>{let s=[...a,...o],d=new DataTransfer;return s.forEach(m=>d.items.add(m)),p?.(d.files),s});else {x(o);let a=new DataTransfer;o.forEach(s=>a.items.add(s)),p?.(a.files);}},[k,p]),R=useCallback(e=>{e&&e.length>0&&(G(e),g?.(e));},[G,g]),Y=useCallback(e=>{e.target.files&&e.target.files.length>0&&R(e.target.files),e.target.value="";},[R]),ee=useCallback(e=>{x(o=>{let a=o.filter((d,m)=>m!==e);if(a.length===0)return p?.(null),[];let s=new DataTransfer;return a.forEach(d=>s.items.add(d)),p?.(s.files),a});},[p]),te=useCallback(e=>{e.preventDefault(),e.stopPropagation(),!r&&(S(o=>o+1),e.dataTransfer.items&&e.dataTransfer.items.length>0&&B(true));},[r]),re=useCallback(e=>{e.preventDefault(),e.stopPropagation(),!r&&S(o=>{let a=o-1;return a===0&&B(false),a});},[r]),oe=useCallback(e=>{e.preventDefault(),e.stopPropagation();},[]),M=useMemo(()=>h?h.split(",").map(e=>e.trim()):null,[h]),ae=useCallback(e=>{if(e.preventDefault(),e.stopPropagation(),r)return;B(false),S(0);let o=e.dataTransfer.files;if(o&&o.length>0)if(M&&M.length>0){let a=Array.from(o).filter(m=>M.some(W=>W.startsWith(".")?m.name.toLowerCase().endsWith(W.toLowerCase()):m.type.match(W.replace("*",".*"))));if(a.length===0)return;let s=new DataTransfer;a.forEach(m=>s.items.add(m));let d=s.files;R(d),g?.(d);}else R(o),g?.(o);},[r,M,R,g]),{root:ne,uploadZoneArea:ie,input:le,content:se,icon:J,text:ue,previewContainer:ce,previewGrid:pe,previewItem:de,previewImage:me,previewRemoveButton:fe}=Ee({variant:N,size:l,isDragging:_,disabled:r,error:!!b$2});return jsxs("div",{className:a(ne(),i),children:[v?jsx("span",{className:a("somaui-upload-zone-label","block",b.size[l],b.weight[E],r&&"text-muted-foreground",C),children:v}):null,jsxs("div",{className:ie({className:w}),onDragEnter:te,onDragOver:oe,onDragLeave:re,onDrop:ae,onClick:e=>{let o=e.target;r||o.closest(".somaui-upload-zone-preview-item")||o.closest("button");},role:"button",tabIndex:r?-1:0,"aria-disabled":r,onKeyDown:e=>{(e.key==="Enter"||e.key===" ")&&!r&&(e.preventDefault(),V.current?.click());},children:[jsx("input",{ref:V,type:"file",name:O,className:le(),disabled:r,multiple:k,accept:h,onChange:Y,"aria-invalid":b$2?"true":void 0,"aria-required":$.required,...$}),jsxs("div",{className:a(se(),Z),children:[L!==null&&jsx("div",{className:J(),children:L||jsx(Le,{className:a("h-8 w-8 text-gray-400 dark:text-gray-500",J())})}),jsx("p",{className:a(ue(),"text-gray-600 dark:text-gray-400",_&&"text-primary"),children:j||ke})]})]}),!b$2&&c?jsx(b$1,{size:l,className:a("somaui-upload-zone-helper-text",r&&"text-muted-foreground",I),children:c}):null,K.length>0&&jsx("div",{className:a(ce(),U),children:jsx("div",{className:pe(),children:K.map((e,o)=>{let a$1=`${e.name}-${e.size}-${e.lastModified}-${o}`;return jsxs("div",{className:a(de(),"somaui-upload-zone-preview-item"),children:[e.type.startsWith("image/")?jsx("div",{className:"aspect-square",children:jsx(Te,{file:e,className:me()})}):jsx("div",{title:e.name,className:"flex aspect-square items-center justify-center",children:jsx("div",{className:"p-4 text-center",children:jsx(Re,{className:"mx-auto mb-2 h-12 w-12 text-gray-400"})})}),jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),ee(o);},className:fe(),"aria-label":`Remove ${e.name}`,children:jsx(De,{className:"h-4 w-4"})}),jsx("div",{className:"absolute right-0 bottom-0 left-0 truncate bg-black/70 px-2 py-1 text-xs text-white",children:e.name}),jsxs("div",{className:"absolute top-2 left-2 rounded bg-black/70 px-2 py-1 text-xs text-white",children:[(e.size/1024).toFixed(1)," KB"]})]},a$1)})})}),b$2?jsx(a$2,{size:l,error:b$2,className:a("somaui-upload-zone-error-text",P)}):null]})}
export{he as FileInput,Ce as UploadZone};