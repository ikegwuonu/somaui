import {createContext,useRef,useState,useContext}from'react';import {FloatingPortal,FloatingArrow,useFloating,autoUpdate,arrow,offset,flip,shift,useInteractions,useRole,useDismiss,useClick,useTransitionStyles}from'@floating-ui/react';import {jsx,jsxs}from'react/jsx-runtime';import {tv,cx}from'tailwind-variants';var H={fadeIn:{initial:{opacity:0},close:{opacity:0}},zoomIn:{initial:{opacity:0,transform:"scale(0.96)"},close:{opacity:0,transform:"scale(0.96)"}},slideIn:{initial:{opacity:0,transform:"translateY(4px)"},close:{opacity:0,transform:"translateY(4px)"}}},S=createContext(null);function w({value:e,children:r}){let{isOpen:o,setIsOpen:t,gap:n,animation:a,placement:c}=e,s=useRef(null),[i,l]=useState(false),{x:m,y,refs:v,strategy:f,context:p}=useFloating({placement:c,open:o??i,onOpenChange:t??l,middleware:[arrow({element:s}),offset(n),flip(),shift({padding:8})],whileElementsMounted:autoUpdate}),{getReferenceProps:u,getFloatingProps:g}=useInteractions([useRole(p,{role:"tooltip"}),useDismiss(p),useClick(p,{enabled:true})]),{isMounted:b,styles:x}=useTransitionStyles(p,a?{duration:{open:150,close:150},...H[a]}:void 0);return jsx(S.Provider,{value:{open:o??i,setOpen:t??l,isMounted:b,styles:x,getReferenceProps:u,getFloatingProps:g,x:m,y,refs:v,strategy:f,arrowRef:s,context:p,...e},children:r})}function d(){let e=useContext(S);if(!e)throw new Error("usePopover must be used within a PopoverProvider");return e}function h({children:e}){let{getReferenceProps:r,refs:o}=d(),t=e,n=r({ref:o.setReference,...t.props});return jsx(t.type,{...n})}function N(...e){return cx(...e)||""}var X=tv({base:"z-[9999] min-w-max bg-background dark:bg-muted/80 dark:backdrop-blur-3xl border-[length:var(--border-width)] border-border rounded-[var(--border-radius)] shadow-[0px_8px_24px_rgba(149,157,165,0.2)]",variants:{size:{sm:"p-2.5",md:"p-4",lg:"p-5"}},defaultVariants:{size:"md"}}),Z=tv({base:"fill-background dark:fill-muted/80 [&>path]:stroke-muted"});function R({children:e,className:r}){let{open:o,setOpen:t,strategy:n,isMounted:a,x:c,y:s,refs:i,styles:l,arrowRef:m,context:y,enableOverlay:v,showArrow:f,getFloatingProps:p,size:u,arrowClassName:g,overlayClassName:b}=d();if(!a&&!o)return null;let x=()=>typeof e=="function"&&t?e({open:o,setOpen:t}):e;return jsxs(FloatingPortal,{children:[v&&jsx("div",{className:N("somaui-popover-overlay","fixed inset-0 z-9998 cursor-pointer bg-black/60 transition-opacity duration-200",!o&&"opacity-0",b),children:jsx("span",{className:"sr-only",children:"popover overlay"})}),jsxs("div",{role:"popover",ref:i.setFloating,className:X({size:u,className:r}),style:{position:n,top:s??0,left:c??0,...l},...p(),children:[x(),f&&jsx(FloatingArrow,{ref:m,context:y,"data-testid":"popover-arrow",className:Z({className:g}),style:{strokeDasharray:"0,14, 5"}})]})]})}R.displayName="PopoverContent";function P({isOpen:e,setIsOpen:r,gap:o=8,animation:t="zoomIn",placement:n="bottom",enableOverlay:a=false,showArrow:c=true,size:s="md",arrowClassName:i,overlayClassName:l,children:m}){return jsx(w,{value:{isOpen:e,setIsOpen:r,gap:o,animation:t,enableOverlay:a,showArrow:c,placement:n,size:s,arrowClassName:i,overlayClassName:l},children:m})}P.Trigger=h;P.Content=R;P.displayName="Popover";export{P as Popover};