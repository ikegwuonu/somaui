import {useState,useCallback,useMemo}from'react';import {Listbox,Label,ListboxButton,ListboxOptions,ListboxOption}from'@headlessui/react';import {tv,cx}from'tailwind-variants';import {jsxs,jsx}from'react/jsx-runtime';function s(...e){return cx(...e)||""}var De=tv({base:"text-red",variants:{size:{sm:"text-[11px] mt-0.5",md:"text-[13px] mt-0.5",lg:"text-[13px] mt-1"}}});function N({as:e="div",error:r,size:o,className:i}){let n=e;return r?jsx(n,{role:"alert","aria-live":"polite",className:De({size:o,className:i}),children:r}):null}N.displayName="FieldErrorText";var $e=tv({variants:{size:{sm:"text-[11px] mt-0.5",md:"text-[13px] mt-0.5",lg:"text-[13px] mt-1"}}});function k({size:e,as:r="div",children:o,className:i}){let n=r;return o?jsx(n,{className:$e({size:e,className:i}),children:o}):null}k.displayName="FieldHelperText";var _e=tv({base:"somaui-input-clear-btn input-clear-btn inline-flex shrink-0 transform items-center justify-center rounded-full bg-muted/70 backdrop-blur text-foreground/90 transition-all duration-200 ease-in-out hover:bg-primary hover:text-primary-foreground",variants:{size:{sm:"h-3.5 w-3.5",md:"h-4 w-4",lg:"h-4 w-4"},hasSuffix:{true:""}},compoundVariants:[{hasSuffix:true,size:"sm",class:"me-1.5"},{hasSuffix:true,size:"md",class:"me-2"},{hasSuffix:true,size:"lg",class:"me-2.5"}]});function P({as:e,size:r,onClick:o,hasSuffix:i,className:n}){return jsx(e||"button",{type:"button",onClick:o,"aria-label":"Clear input",className:_e({size:r,hasSuffix:i,className:n}),children:jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-4 w-auto","aria-hidden":"true",children:jsx("path",{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})})})}P.displayName="FieldClearButton";function U(e){return jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:e.strokeWidth??1.5,stroke:"currentColor",...e,children:jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})}var _={normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold"};var T={weight:_,size:{sm:"text-xs mb-1",md:"text-sm mb-1.5",lg:"text-sm mb-1.5"}};function Q(e){return jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})})}function O(e){return typeof e=="string"||e instanceof String}function f(e){return typeof e=="number"&&isFinite(e)}function L(e){return e==null?true:typeof e=="string"||Array.isArray(e)?e.length===0:typeof e=="object"?Object.keys(e).length===0:false}var q=(e,r)=>{let o=r!==void 0,[i,n]=useState(e);return [o?r:i,u=>{o||n(u);}]},V={top:"top",right:"right",bottom:"bottom",left:"left","top-start":"top start","top-end":"top end","bottom-start":"bottom start","bottom-end":"bottom end","right-start":"right start","right-end":"right end","left-start":"left start","left-end":"left end"};function E(e){(!["ArrowUp","ArrowDown","Enter","Home","End","Escape"].includes(e.key)||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)&&e.stopPropagation();}function J(e,r,o,i){return useMemo(()=>i?e:e.filter(n=>{let p=n[o];return p?String(p).toLowerCase().includes(r.toLowerCase()):false}),[r,e,i,o])}function X(e){return e}function Y({value:e,label:r}){return r||e||"Error: use getOptionDisplayValue prop"}function Z(e){return O(e)||f(e)?e:e?.label?e.label:e?.name?e.name:e?.value?e.value:String(e)}var F={base:"z-[999] border-[length:var(--border-width)] border-border bg-background !p-1.5 focus-visible:outline-none dark:bg-muted/80 dark:backdrop-blur-sm rounded-[var(--border-radius)]",shadow:"shadow-[0px_8px_24px_rgba(149,157,165,0.2)]"};var c={base:`${F.base} overflow-auto w-[var(--button-width)] !outline-none !ring-0 m-0 [&>li]:!m-0 [scrollbar-width:thin] [scrollbar-color:rgba(0,0,0,0.2)_rgba(0,0,0,0)] [-ms-overflow-style:none] [&::-webkit-scrollbar-track]:shadow-none [&::-webkit-scrollbar-track]:bg-transparent [&::-webkit-scrollbar]:bg-transparent [&::-webkit-scrollbar]:w-[5px] [&::-webkit-scrollbar-thumb]:bg-muted [&::-webkit-scrollbar-thumb]:rounded-lg data-[open]:opacity-100 data-[leave]:data-[closed]:opacity-100`,shadow:F.shadow,item:{size:{sm:"text-xs",md:"text-sm",lg:"text-base"}},inPortal:"[--anchor-max-height:256px]",notInPortal:"absolute z-10 h-[256px] start-0 top-full mt-1.5"},d={base:"relative mb-2 block group [&.sticky]:mb-0",inputBase:"px-10 placeholder:text-muted-foreground",prefix:"absolute z-10 start-1 top-5 group-[.sticky]:top-7 inline-block -translate-y-1/2 whitespace-nowrap leading-normal text-muted-foreground",suffix:"absolute z-10 end-1 top-5 group-[.sticky]:top-7 inline-block -translate-y-1/2 whitespace-nowrap leading-normal text-muted-foreground",stickySearch:"sticky top-0 z-10 bg-background pt-2 -translate-y-2"};var ee=tv({base:"flex group items-center peer border-[length:var(--border-width)] hover:border-primary w-full transition duration-200 hover:ring-primary focus:border-primary focus:ring-[0.8px] focus:ring-primary rounded-[var(--border-radius)]",variants:{variant:{text:"border-transparent ring-transparent bg-transparent",outline:"border-border ring-border bg-transparent"},size:{sm:"px-2 py-1 text-xs h-8",md:"px-3 py-2 text-sm h-10",lg:"px-4 py-2 text-base h-12"},disabled:{true:"!bg-muted/70 backdrop-blur cursor-not-allowed !border-muted text-muted-foreground placeholder:text-muted-foreground !ring-muted"},error:{true:"!border-red hover:!border-red focus:!border-red !ring-red"},hasPrefix:{true:""},hasSuffix:{true:""}},compoundVariants:[{hasPrefix:true,class:"ps-2.5"},{hasSuffix:true,class:"pe-2.5"}],defaultVariants:{variant:"outline",size:"md"}});function te({label:e,labelWeight:r="medium",error:o,options:i,disabled:n,autoFocus:p,helperText:h,prefix:u=null,placeholder:re="Select...",inPortal:b=true,modal:oe=false,displayValue:ae=Z,getOptionDisplayValue:se=Y,getOptionValue:H=X,getOptionValueKey:S,value:v,defaultValue:ne,onChange:R,onClear:B,clearable:ie,placement:le="bottom-start",gap:pe=6,size:l="md",variant:I="outline",suffix:g=jsx(U,{strokeWidth:"2",className:"size-4"}),searchable:ce,searchType:de,searchProps:me,stickySearch:ue,searchPrefix:M=jsx(Q,{strokeWidth:"2",className:"size-4"}),searchSuffix:A=null,searchDisabled:D,searchReadOnly:fe,onSearchChange:be,searchPlaceHolder:ge="Search...",className:xe,searchByKey:ye="label",labelClassName:he,selectClassName:Se,optionClassName:ve,suffixClassName:we,prefixClassName:Ne,errorClassName:ke,helperClassName:Ce,searchClassName:Pe,dropdownClassName:Te,disableDefaultFilter:Oe,searchPrefixClassName:Le,searchSuffixClassName:Ve,searchContainerClassName:Ee,...Fe}){let[ze,K]=q(ne,v),[W,$]=useState(""),x=v!==void 0?v:ze,y=!f(x)&&L(x),He=J(i,W,ye,Oe),Re=useCallback(t=>{t?.stopPropagation(),$(""),B?.(t);},[B]),Be=useCallback(t=>{K(t),R?.(t);},[R,K]),Ie=useCallback(t=>S?t[S]:H(t),[H,S]);return jsxs("div",{className:s("somaui-select-root","grid w-full grid-cols-1",xe),children:[jsx(Listbox,{value:x,onChange:Be,disabled:n,...Fe,children:jsxs("div",{className:"contents",children:[e&&jsx(Label,{className:s("somaui-select-label","block",T.size[l],T.weight[r],n&&"text-muted-foreground",he),children:e}),jsxs("div",{className:s(!b&&"relative"),children:[jsxs(ListboxButton,{className:ee({variant:I,size:l,disabled:n,error:!!(o&&y),hasPrefix:!!u,hasSuffix:!!g,className:Se}),autoFocus:p,children:[u&&jsx("span",{className:s("somaui-select-prefix","block leading-normal whitespace-nowrap",Ne),children:u}),jsx("span",{className:s("somaui-select-value","block w-full truncate text-left rtl:text-right",y&&"text-muted-foreground"),children:y?re:ae(x)}),ie&&!y&&jsx(P,{as:"span",size:l,onClick:Re,hasSuffix:!!g}),g&&jsx("span",{className:s("somaui-select-suffix","leading-normal whitespace-nowrap transition-transform duration-200 group-data-open:rotate-180",we),children:g})]}),jsxs(ListboxOptions,{modal:oe,portal:b,...b&&{anchor:{to:V[le],gap:pe}},className:s("somaui-select-options",c.base,c.shadow,b?c.inPortal:c.notInPortal,Te),children:[ce&&jsxs("div",{className:s(d.base,ue&&d.stickySearch,Ee),children:[M&&jsx("span",{className:s("somaui-select-prefix",d.prefix,Le),children:M}),jsx("input",{type:de,spellCheck:false,value:W,disabled:D,readOnly:fe,placeholder:ge,onChange:t=>{$(t.target.value),be?.(t.target.value);},onKeyDown:t=>E(t),className:ee({variant:I,size:l,disabled:D,className:s(d.inputBase,Pe)}),...me}),A&&jsx("span",{className:s("somaui-select-suffix",d.suffix,Ve),children:A})]}),He.map(t=>jsx(ListboxOption,{...t?.disabled&&{disabled:t?.disabled},className:({focus:w})=>s("somaui-select-option","flex w-full items-center px-3 py-1.5",w&&"bg-muted/70","rounded-[calc(var(--border-radius)/2)]",l&&c.item.size[l],!t?.disabled&&"cursor-pointer",ve),value:Ie(t),children:({selected:w})=>jsx("div",{className:s(w?"font-medium":"text-foreground"),children:se(t)})},t.value))]})]})]})}),!o&&h&&jsx(k,{size:l,className:Ce,children:h}),o&&jsx(N,{size:l,error:o,className:ke})]})}te.displayName="Select";
export{te as Select};